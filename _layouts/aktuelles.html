---
layout: default
---

<section class="page-hero">
  <img src="{{ site.baseurl }}/assets/images/{{ page.hero_image }}"
       class="page-hero-bg" alt="Aktuelles RG Hamburg">
  <div class="page-hero-overlay"></div>
  <div class="container h-100 position-relative">
    <div class="page-hero-title-box">
      <h1 class="page-hero-title">Aktuelles</h1>
    </div>
  </div>
</section>

{% include events.html %}

{% include news.html %}

<div id="aktuelles-pagination" class="bg-rg-light py-4 d-flex justify-content-center align-items-center gap-3" style="display:none"></div>

<script>
document.addEventListener('DOMContentLoaded', function () {
  var PAGE1 = 4, PAGEN = 8;
  var allCards      = Array.from(document.querySelectorAll('[data-post-idx]'));
  var eventsSection = document.getElementById('veranstaltungen');
  var pager         = document.getElementById('aktuelles-pagination');
  var filterBtns    = Array.from(document.querySelectorAll('[data-filter-tag]'));
  var activeTag     = null;
  var page          = 1;

  var total      = allCards.length;
  var totalPages = total <= PAGE1 ? 1 : 1 + Math.ceil((total - PAGE1) / PAGEN);

  function show(p) {
    if (activeTag !== null) return;
    page = p;
    if (p === 1) {
      if (eventsSection) eventsSection.style.display = '';
      allCards.forEach(function (c, i) { c.style.display = i < PAGE1 ? '' : 'none'; });
    } else {
      if (eventsSection) eventsSection.style.display = 'none';
      var start = PAGE1 + (p - 2) * PAGEN;
      allCards.forEach(function (c, i) {
        c.style.display = (i >= start && i < start + PAGEN) ? '' : 'none';
      });
    }
    renderPager();
    window.scrollTo({ top: 0, behavior: 'smooth' });
    var url = p === 1 ? location.pathname : location.pathname + '?page=' + p;
    history.pushState({ page: p }, '', url);
  }

  function mkBtn(label, targetPage) {
    var el = document.createElement('button');
    el.textContent = label;
    el.className = 'btn btn-rg-outline';
    el.onclick = function () { show(targetPage); };
    return el;
  }

  function renderPager() {
    if (totalPages <= 1) { pager.style.display = 'none'; return; }
    pager.style.display = 'flex';
    pager.innerHTML = '';
    if (page > 1) pager.appendChild(mkBtn('← Neuere', page - 1));
    var info = document.createElement('span');
    info.style.color = 'var(--rg-text-grey)';
    info.textContent = 'Seite ' + page + ' von ' + totalPages;
    pager.appendChild(info);
    if (page < totalPages) pager.appendChild(mkBtn('Ältere →', page + 1));
  }

  function applyFilter(tag) {
    activeTag = tag || null;
    filterBtns.forEach(function (btn) {
      btn.classList.toggle('active', btn.dataset.filterTag === (tag || ''));
    });
    if (activeTag) {
      if (eventsSection) eventsSection.style.display = 'none';
      pager.style.display = 'none';
      allCards.forEach(function (c) {
        c.style.display = (c.dataset.tag === activeTag) ? '' : 'none';
      });
    } else {
      show(1);
    }
  }

  filterBtns.forEach(function (btn) {
    btn.addEventListener('click', function () {
      applyFilter(btn.dataset.filterTag);
    });
  });

  var initPage = parseInt(new URLSearchParams(location.search).get('page')) || 1;
  initPage = Math.min(Math.max(initPage, 1), totalPages);
  history.replaceState({ page: initPage }, '', location.href);
  show(initPage);

  window.addEventListener('popstate', function (e) {
    if (e.state && e.state.page) {
      activeTag = null;
      filterBtns.forEach(function (btn) {
        btn.classList.toggle('active', btn.dataset.filterTag === '');
      });
      show(e.state.page);
    }
  });
});
</script>

{% include probetraining.html %}
